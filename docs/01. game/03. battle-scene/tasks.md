# 배틀씬 MVP 작업 리스트

**생성일**: 2025-12-28
**대상**: Phase 1 프로토타입 (React + TypeScript)
**버전**: MVP (Minimum Viable Product)

---

## MVP 개요

### 핵심 목표
플레이어가 드래그앤드롭으로 카드를 사용하여 적을 처치하는 기본 전투 루프 검증

### 레이아웃
```
┌─────────────────────────────────────────────────┐
│                    턴 정보                        │
├──────────────────────┬──────────────────────────┤
│                      │                          │
│   🧙 플레이어         │         👹 적            │
│   HP 바              │         HP 바            │
│   에너지 게이지        │         반격 정보         │
│                      │                          │
├──────────────────────┴──────────────────────────┤
│                                                 │
│              🃏 손패 카드 (드래그 가능)             │
│                                                 │
├─────────────────────────────────────────────────┤
│                   턴 종료 버튼                    │
└─────────────────────────────────────────────────┘
```

### 카드 사용 방식
- **오른쪽(적)으로 드래그**: 공격/적 대상 카드 사용
- **왼쪽(플레이어)으로 드래그**: 자신에게 사용하는 카드

### 기술 스택
- React 19 + TypeScript 5.9 (strict mode)
- Zustand 5.0 (상태 관리)
- Tailwind CSS 4.1 (스타일링)
- Framer Motion 12 (드래그 + 애니메이션)

### MVP 제약
- 사운드 제외
- 데이터 수집/설문조사 제외
- A/B 선택 모달 제외 (드래그 방향으로 대체)
- 전투 로그 UI 제외
- 고급 애니메이션 제외 (데미지 팝업, 카드 날아가기 등)

---

## Phase 1: 기초 인프라

### TASK-001: TypeScript 타입 정의

**설명**: 배틀씬에서 사용할 TypeScript 인터페이스 정의

**작업 내용**:
- `types/battle.ts` 파일 생성 (또는 기존 `types/index.ts` 수정)
- 인터페이스 정의:
  - `Player`: HP, 에너지, 최대값
  - `Enemy`: HP, 반격 데미지
  - `Card`: ID, 이름, 에너지 비용, 효과 타입, 대상(적/플레이어)
  - `BattlePhase`: 'battle' | 'victory' | 'defeat'

**완료 조건**:
- [ ] 모든 타입 정의 완료
- [ ] strict mode에서 에러 없음
- [ ] 한국어 주석 추가

**예상 난이도**: 낮음

---

### TASK-002: 카드 데이터 정의

**설명**: MVP용 카드 데이터 작성 (6장)

**작업 내용**:
- `data/cards.ts` 수정
- 카드별 대상 명시:
  - **적 대상 카드** (오른쪽 드래그): 공격 카드
  - **플레이어 대상 카드** (왼쪽 드래그): 회복/버프 카드
- 각 카드에 `target: 'enemy' | 'player'` 필드 추가

**카드 예시**:
| 카드명 | 비용 | 대상 | 효과 |
|--------|------|------|------|
| 강타 | 2 | 적 | 15 데미지 |
| 연속 공격 | 3 | 적 | 25 데미지 |
| 회복 | 1 | 플레이어 | HP +10 |
| 에너지 충전 | 1 | 플레이어 | 다음 턴 에너지 +1 |
| 방어 태세 | 1 | 플레이어 | 이번 턴 반격 무효화 |
| 집중 타격 | 3 | 적 | 35 데미지, HP -5 |

**완료 조건**:
- [ ] 6장 카드 데이터 완성
- [ ] 각 카드에 `target` 필드 추가
- [ ] 밸런스 고려 (적 HP 100 기준)

**예상 난이도**: 낮음

---

### TASK-003: Zustand 배틀 스토어

**설명**: 배틀 상태 관리 스토어 생성

**작업 내용**:
- `stores/battleStore.ts` 수정
- 상태:
  - `phase`: 게임 페이즈
  - `currentTurn`: 현재 턴
  - `player`: 플레이어 상태
  - `enemy`: 적 상태
  - `hand`: 손패 카드
  - `usedCards`: 사용한 카드 ID
  - `skipCounter`: 반격 무효화 여부
- 액션:
  - `startGame()`: 게임 초기화
  - `playCard(cardId)`: 카드 사용
  - `endTurn()`: 턴 종료 (반격 처리)
  - `checkGameOver()`: 승패 판정
  - `resetGame()`: 게임 리셋

**완료 조건**:
- [ ] Zustand 패턴 준수
- [ ] 불변성 유지
- [ ] 한국어 주석

**예상 난이도**: 중간

---

## Phase 2: 핵심 게임 로직

### TASK-004: 카드 플레이 로직

**설명**: 카드 사용 시 효과 적용 로직

**작업 내용**:
- `playCard(cardId)` 구현:
  - 에너지 비용 체크
  - 카드 대상(enemy/player)에 따라 효과 적용
  - 적 대상: 데미지 적용
  - 플레이어 대상: 회복/버프 적용
  - 사용한 카드 `usedCards`에 추가

**완료 조건**:
- [ ] 에너지 부족 시 사용 불가
- [ ] 대상별 효과 정확히 적용
- [ ] 사용한 카드 표시

**예상 난이도**: 중간

---

### TASK-005: 턴 시스템 및 반격

**설명**: 턴 종료 및 적 반격 처리

**작업 내용**:
- `endTurn()` 구현:
  - 반격 처리 (skipCounter가 아니면 -10 HP)
  - 턴 카운트 증가
  - 에너지 회복 (최대 3)
  - 턴 상태 초기화 (skipCounter = false)
- 승패 체크 호출

**완료 조건**:
- [ ] 반격 데미지 정확히 적용
- [ ] 반격 무효화 정상 동작
- [ ] 에너지 회복 정상 동작

**예상 난이도**: 낮음

---

### TASK-006: 승패 판정

**설명**: 승리/패배 조건 체크

**작업 내용**:
- `checkGameOver()` 구현:
  - 적 HP ≤ 0 → `phase: 'victory'`
  - 플레이어 HP ≤ 0 → `phase: 'defeat'`

**완료 조건**:
- [ ] 승리 조건 정확히 판정
- [ ] 패배 조건 정확히 판정
- [ ] 페이즈 전환 정상 동작

**예상 난이도**: 낮음

---

## Phase 3: UI 컴포넌트

### TASK-007: 배틀씬 레이아웃

**설명**: 좌우 배치 레이아웃 구현

**작업 내용**:
- `components/BattleScene.tsx` 수정
- 레이아웃:
  - 상단: 턴 정보
  - 중앙 좌측: 플레이어 영역 (HP, 에너지)
  - 중앙 우측: 적 영역 (HP, 반격 정보)
  - 하단: 손패 카드 + 턴 종료 버튼
- Tailwind CSS flexbox/grid 사용

**완료 조건**:
- [ ] 좌우 배치 정상 표시
- [ ] 반응형 고려 (최소 1280x720)
- [ ] 영역 구분 명확

**예상 난이도**: 중간

---

### TASK-008: 드래그 가능한 카드 컴포넌트

**설명**: Framer Motion 드래그 기능 구현

**작업 내용**:
- `components/DraggableCard.tsx` 생성
- Framer Motion `motion.div` + `drag` 속성 사용
- 드래그 시 카드 시각 변화 (확대, 그림자)
- 드롭 영역 감지:
  - X 좌표 기준: 왼쪽(플레이어) / 오른쪽(적)
- 드롭 성공 시 `playCard()` 호출
- 드롭 실패 시 원래 위치로 복귀

**완료 조건**:
- [ ] 드래그 정상 동작
- [ ] 드롭 영역 정확히 감지
- [ ] 에너지 부족 카드는 드래그 제한 또는 시각적 피드백
- [ ] 대상 불일치 시 드롭 실패 (적 카드를 플레이어로 드래그 등)

**예상 난이도**: 높음

---

### TASK-009: 드롭 영역 컴포넌트

**설명**: 카드 드롭 대상 영역 구현

**작업 내용**:
- `components/DropZone.tsx` 생성
- 플레이어 영역: 왼쪽 드롭존
- 적 영역: 오른쪽 드롭존
- 드래그 중 유효한 드롭존 하이라이트
- 드롭 시 콜백 호출

**완료 조건**:
- [ ] 드롭존 시각적 표시
- [ ] 유효 드롭 시 하이라이트
- [ ] 드롭 이벤트 정상 처리

**예상 난이도**: 중간

---

### TASK-010: HP/에너지 UI

**설명**: 플레이어/적 상태 표시

**작업 내용**:
- 플레이어 영역:
  - HP 바 (애니메이션)
  - 에너지 게이지 (3개 원형)
- 적 영역:
  - HP 바 (애니메이션)
  - 반격 정보 표시 ("턴 종료 시 -10")

**완료 조건**:
- [ ] HP 바 정확히 표시
- [ ] 에너지 게이지 정확히 표시
- [ ] HP 변화 시 애니메이션

**예상 난이도**: 낮음

---

### TASK-011: 손패 카드 영역

**설명**: 드래그 가능한 손패 카드 배치

**작업 내용**:
- `components/Hand.tsx` 수정
- 6장 카드 가로 배치
- 각 카드에 `DraggableCard` 사용
- 사용한 카드 흐리게 표시
- 에너지 부족 카드 표시

**완료 조건**:
- [ ] 6장 카드 정상 표시
- [ ] 드래그 가능
- [ ] 사용 불가 카드 시각적 구분

**예상 난이도**: 중간

---

### TASK-012: 승리/패배 화면

**설명**: 게임 결과 화면

**작업 내용**:
- `components/ResultScreen.tsx` 생성 (또는 기존 수정)
- 승리 시: "승리!" + 재시작 버튼
- 패배 시: "패배..." + 재시작 버튼
- Framer Motion 등장 애니메이션

**완료 조건**:
- [ ] 승리/패배 정확히 표시
- [ ] 재시작 버튼 정상 동작
- [ ] 애니메이션 적용

**예상 난이도**: 낮음

---

## Phase 4: 통합 및 테스트

### TASK-013: 메인 앱 통합

**설명**: 배틀씬을 메인 앱에 통합

**작업 내용**:
- `App.tsx` 수정
- phase별 조건부 렌더링:
  - 'battle' → 배틀씬
  - 'victory' / 'defeat' → 결과 화면

**완료 조건**:
- [ ] 페이즈 전환 정상 동작
- [ ] 재시작 시 상태 초기화

**예상 난이도**: 낮음

---

### TASK-014: 플레이테스트 및 버그 수정

**설명**: 전체 흐름 테스트

**작업 내용**:
- 전체 게임 플레이 테스트
- 드래그앤드롭 동작 확인
- 엣지 케이스 확인:
  - 에너지 0일 때
  - HP 0 미만 방지
  - 잘못된 대상에 드롭
- 버그 수정

**완료 조건**:
- [ ] TypeScript 컴파일 에러 없음
- [ ] ESLint 통과
- [ ] 콘솔 에러 없음
- [ ] 전체 게임 루프 정상 동작

**예상 난이도**: 중간

---

## 작업 요약

| Phase | 작업 개수 | 예상 난이도 분포 |
|-------|----------|-----------------|
| Phase 1: 기초 인프라 | 3 | 낮음 2, 중간 1 |
| Phase 2: 핵심 게임 로직 | 3 | 낮음 2, 중간 1 |
| Phase 3: UI 컴포넌트 | 6 | 낮음 2, 중간 3, 높음 1 |
| Phase 4: 통합 및 테스트 | 2 | 낮음 1, 중간 1 |
| **전체** | **14** | **낮음 7, 중간 6, 높음 1** |

---

## 핵심 의존성 체인

```
TASK-001 (타입 정의)
  └─→ TASK-002 (카드 데이터)
       └─→ TASK-003 (스토어)
            ├─→ TASK-004 (카드 플레이)
            ├─→ TASK-005 (턴 시스템)
            └─→ TASK-006 (승패 판정)
                 │
TASK-007 (레이아웃) ←─┘
  ├─→ TASK-008 (드래그 카드) ★ 핵심
  ├─→ TASK-009 (드롭 영역)
  ├─→ TASK-010 (HP/에너지)
  └─→ TASK-011 (손패)
       └─→ TASK-012 (결과 화면)
            └─→ TASK-013 (통합)
                 └─→ TASK-014 (테스트)
```

---

## MVP 이후 확장 가능 기능

다음 기능들은 MVP 완료 후 추가 가능:
- 5턴 제한 (마지막 턴 경고)
- 데이터 수집 (설문조사, 선택 시간)
- 데미지 숫자 팝업
- 카드 날아가는 애니메이션
- 공격/반격 이펙트 (흔들림)
- 전투 로그 UI
- 키보드 단축키

---

**문서 종료**
